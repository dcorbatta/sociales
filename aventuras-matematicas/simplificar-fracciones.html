<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🧩 Simplificar Fracciones - Aventuras Matemáticas</title>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        .fraction-display {
            font-size: 3rem;
            text-align: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .simplification-process {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid #4facfe;
        }

        .step-by-step {
            display: flex;
            align-items: center;
            margin: 15px 0;
            padding: 15px;
            background: rgba(79, 172, 254, 0.1);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .step-by-step:hover {
            background: rgba(79, 172, 254, 0.2);
            transform: translateX(10px);
        }

        .step-number {
            background: #4facfe;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .factor-finder {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
        }

        .number-input {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .number-input input {
            width: 100px;
            padding: 15px;
            font-size: 1.5rem;
            text-align: center;
            border: 2px solid #4facfe;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.9);
        }

        .fraction-line {
            width: 80px;
            height: 3px;
            background: #333;
            margin: 0 10px;
        }

        .factors-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .factor-box {
            background: white;
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #ff9800;
            text-align: center;
        }

        .factor-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin: 10px 0;
        }

        .factor-item {
            background: #ff9800;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .factor-item.common {
            background: #4caf50;
            animation: glow 1.5s infinite alternate;
        }

        @keyframes glow {
            0% { box-shadow: 0 0 10px rgba(76, 175, 80, 0.5); }
            100% { box-shadow: 0 0 20px rgba(76, 175, 80, 0.8); }
        }

        .simplification-game {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            text-align: center;
        }

        .fraction-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .fraction-card {
            background: white;
            border: 3px solid #2196f3;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.3rem;
            font-weight: bold;
        }

        .fraction-card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(33, 150, 243, 0.3);
        }

        .fraction-card.simplified {
            border-color: #4caf50;
            background: linear-gradient(135deg, #e8f5e8, #c8e6c9);
        }

        .fraction-card.complex {
            border-color: #ff9800;
            background: linear-gradient(135deg, #fff3e0, #ffcc80);
        }

        .fraction-card.selected {
            transform: scale(1.1);
            box-shadow: 0 15px 35px rgba(33, 150, 243, 0.4);
        }

        .drag-drop-area {
            display: flex;
            justify-content: space-around;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .drop-zone {
            background: rgba(255, 255, 255, 0.8);
            border: 3px dashed #4facfe;
            border-radius: 20px;
            padding: 30px;
            min-height: 150px;
            min-width: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .drop-zone.drag-over {
            background: rgba(79, 172, 254, 0.2);
            border-color: #2196f3;
            transform: scale(1.05);
        }

        .drop-zone.correct {
            background: rgba(76, 175, 80, 0.2);
            border-color: #4caf50;
        }

        .drop-zone.incorrect {
            background: rgba(244, 67, 54, 0.2);
            border-color: #f44336;
        }

        .calculator-section {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
        }

        .calculator-display {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            text-align: center;
            border: 2px solid #ff9800;
        }

        .calculation-steps {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            text-align: left;
        }

        .result-display {
            font-size: 2rem;
            color: #4caf50;
            font-weight: bold;
            margin: 15px 0;
            padding: 15px;
            background: rgba(76, 175, 80, 0.1);
            border-radius: 10px;
        }

        .practice-exercises {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            border: 3px solid #9c27b0;
        }

        .exercise-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            margin: 10px 0;
            background: rgba(156, 39, 176, 0.1);
            border-radius: 10px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .exercise-fraction {
            font-size: 1.5rem;
            font-weight: bold;
            color: #9c27b0;
        }

        .answer-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .answer-input input {
            width: 60px;
            padding: 10px;
            font-size: 1.2rem;
            text-align: center;
            border: 2px solid #9c27b0;
            border-radius: 8px;
        }

        .check-btn {
            background: #9c27b0;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .check-btn:hover {
            background: #7b1fa2;
            transform: scale(1.05);
        }

        .result-icon {
            font-size: 1.5rem;
            margin-left: 10px;
        }

        .progress-tracker {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .progress-bar {
            background: #e0e0e0;
            border-radius: 10px;
            height: 20px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .achievement-badge {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            border: 3px solid #ff9800;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 10px auto;
            animation: spin 3s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>🧩 Simplificar Fracciones</h1>
            <div class="score-board">
                <span class="score">🌟 Puntos: <span id="points">0</span></span>
                <span class="level">🎯 Ejercicio: <span id="currentExercise">1</span>/10</span>
            </div>
        </header>

        <main class="main-content">
            <!-- Lección Teórica -->
            <section class="lesson-section">
                <div class="lesson-card">
                    <h2>🔍 ¿Cómo Simplificar Fracciones?</h2>
                    <p>Simplificar una fracción significa encontrar una fracción equivalente con números más pequeños. Para esto, dividimos el numerador y denominador por su <strong>máximo común divisor (MCD)</strong>.</p>
                    
                    <div class="simplification-process">
                        <h3>📋 Proceso paso a paso:</h3>
                        <div class="step-by-step">
                            <div class="step-number">1</div>
                            <div>Encuentra los factores del numerador y denominador</div>
                        </div>
                        <div class="step-by-step">
                            <div class="step-number">2</div>
                            <div>Identifica el máximo común divisor (MCD)</div>
                        </div>
                        <div class="step-by-step">
                            <div class="step-number">3</div>
                            <div>Divide tanto numerador como denominador por el MCD</div>
                        </div>
                        <div class="step-by-step">
                            <div class="step-number">✓</div>
                            <div>¡Obtienes la fracción simplificada!</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Calculadora de Simplificación -->
            <section class="calculator-section">
                <h3>🔢 Calculadora de Simplificación</h3>
                <p>Ingresa una fracción y te mostraré cómo simplificarla paso a paso:</p>
                
                <div class="calculator-display">
                    <div class="number-input">
                        <input type="number" id="calcNum" placeholder="12" min="1" max="100">
                        <div class="fraction-line"></div>
                        <input type="number" id="calcDen" placeholder="18" min="1" max="100">
                        <button class="btn-primary" onclick="calculateSimplification()">🧮 Simplificar</button>
                    </div>
                    
                    <div id="calculationResult" style="display: none;">
                        <div class="calculation-steps" id="calculationSteps"></div>
                        <div class="result-display" id="finalResult"></div>
                    </div>
                </div>
            </section>

            <!-- Buscador de Factores -->
            <section class="factor-finder">
                <h3>🔍 Encuentra los Factores</h3>
                <p>Practica encontrando factores y el MCD:</p>
                
                <div class="number-input">
                    <input type="number" id="factorNum" placeholder="24" min="1" max="50">
                    <span style="font-size: 1.5rem; font-weight: bold;">y</span>
                    <input type="number" id="factorDen" placeholder="36" min="1" max="50">
                    <button class="btn-primary" onclick="findFactors()">🔍 Encontrar Factores</button>
                </div>
                
                <div class="factors-display" id="factorsDisplay" style="display: none;">
                    <!-- Se llenará dinámicamente -->
                </div>
            </section>

            <!-- Juego de Clasificación -->
            <section class="simplification-game">
                <h3>🎮 Juego: Clasifica las Fracciones</h3>
                <p>Arrastra las fracciones a la zona correcta:</p>
                
                <div class="fraction-cards" id="gameCards">
                    <!-- Se generará dinámicamente -->
                </div>
                
                <div class="drag-drop-area">
                    <div class="drop-zone" id="simplifiedZone" ondrop="drop(event)" ondragover="allowDrop(event)">
                        <h4>✅ Ya Simplificadas</h4>
                        <p>Fracciones que no se pueden reducir más</p>
                    </div>
                    <div class="drop-zone" id="complexZone" ondrop="drop(event)" ondragover="allowDrop(event)">
                        <h4>🔧 Se Pueden Simplificar</h4>
                        <p>Fracciones que se pueden reducir</p>
                    </div>
                </div>
                
                <button class="btn-primary" onclick="startClassificationGame()">🎮 Nuevo Juego</button>
                <button class="btn-secondary" onclick="checkClassification()">✓ Verificar</button>
            </section>

            <!-- Ejercicios de Práctica -->
            <section class="practice-exercises">
                <h3>📝 Ejercicios de Práctica</h3>
                <p>Simplifica estas fracciones:</p>
                
                <div id="practiceContainer">
                    <!-- Se generará dinámicamente -->
                </div>
                
                <div class="progress-tracker">
                    <div class="progress-bar">
                        <div class="progress-fill" id="practiceProgress" style="width: 0%"></div>
                    </div>
                    <p>Ejercicios completados: <span id="completedExercises">0</span>/10</p>
                </div>
            </section>

            <!-- Logros -->
            <section class="achievements-section" id="achievementsSection" style="display: none;">
                <div class="exercise-card" style="text-align: center;">
                    <h3>🏆 ¡Logro Desbloqueado!</h3>
                    <div class="achievement-badge">🧩</div>
                    <h4>Maestro de la Simplificación</h4>
                    <p>Has completado todos los ejercicios de simplificación</p>
                </div>
            </section>

            <div class="navigation">
                <a href="index.html" class="btn-secondary">🏠 Volver al Menú</a>
                <a href="problemas-fracciones.html" class="btn-primary">➡️ Siguiente: Problemas con Fracciones</a>
            </div>
        </main>
    </div>

    <script src="script.js"></script>
    <script>
        let points = 0;
        let currentExerciseNum = 1;
        let completedExercises = 0;
        let gameCards = [];
        
        const practiceExercises = [
            {num: 6, den: 9, ansNum: 2, ansDen: 3},
            {num: 8, den: 12, ansNum: 2, ansDen: 3},
            {num: 10, den: 15, ansNum: 2, ansDen: 3},
            {num: 12, den: 16, ansNum: 3, ansDen: 4},
            {num: 14, den: 21, ansNum: 2, ansDen: 3},
            {num: 18, den: 24, ansNum: 3, ansDen: 4},
            {num: 20, den: 25, ansNum: 4, ansDen: 5},
            {num: 15, den: 20, ansNum: 3, ansDen: 4},
            {num: 27, den: 36, ansNum: 3, ansDen: 4},
            {num: 35, den: 42, ansNum: 5, ansDen: 6}
        ];

        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            updateDisplay();
            generatePracticeExercises();
            startClassificationGame();
        });

        function updateDisplay() {
            document.getElementById('points').textContent = points;
            document.getElementById('currentExercise').textContent = currentExerciseNum;
            document.getElementById('completedExercises').textContent = completedExercises;
            
            const progress = (completedExercises / practiceExercises.length) * 100;
            document.getElementById('practiceProgress').style.width = progress + '%';
        }

        function addPoints(amount) {
            points += amount;
            updateDisplay();
            showFloatingPoints(amount);
        }

        function showFloatingPoints(points) {
            const pointsEl = document.createElement('div');
            pointsEl.textContent = `+${points}`;
            pointsEl.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                color: #4caf50;
                font-size: 2rem;
                font-weight: bold;
                pointer-events: none;
                z-index: 1000;
                animation: floatUp 2s ease-out forwards;
            `;
            document.body.appendChild(pointsEl);
            setTimeout(() => pointsEl.remove(), 2000);
        }

        // Función para encontrar MCD
        function gcd(a, b) {
            while (b !== 0) {
                let temp = b;
                b = a % b;
                a = temp;
            }
            return a;
        }

        function getFactors(n) {
            const factors = [];
            for (let i = 1; i <= n; i++) {
                if (n % i === 0) {
                    factors.push(i);
                }
            }
            return factors;
        }

        function calculateSimplification() {
            const num = parseInt(document.getElementById('calcNum').value);
            const den = parseInt(document.getElementById('calcDen').value);
            
            if (!num || !den) {
                alert('Por favor ingresa ambos números');
                return;
            }
            
            const mcd = gcd(num, den);
            const simplifiedNum = num / mcd;
            const simplifiedDen = den / mcd;
            
            const steps = document.getElementById('calculationSteps');
            steps.innerHTML = `
                <h4>Pasos de simplificación:</h4>
                <p><strong>1.</strong> Fracción original: ${num}/${den}</p>
                <p><strong>2.</strong> Encontrar MCD de ${num} y ${den} = ${mcd}</p>
                <p><strong>3.</strong> Dividir numerador: ${num} ÷ ${mcd} = ${simplifiedNum}</p>
                <p><strong>4.</strong> Dividir denominador: ${den} ÷ ${mcd} = ${simplifiedDen}</p>
            `;
            
            const result = document.getElementById('finalResult');
            if (mcd === 1) {
                result.innerHTML = `✅ La fracción ${num}/${den} ya está simplificada`;
            } else {
                result.innerHTML = `🎯 Resultado: ${num}/${den} = ${simplifiedNum}/${simplifiedDen}`;
            }
            
            document.getElementById('calculationResult').style.display = 'block';
            addPoints(15);
        }

        function findFactors() {
            const num = parseInt(document.getElementById('factorNum').value);
            const den = parseInt(document.getElementById('factorDen').value);
            
            if (!num || !den) {
                alert('Por favor ingresa ambos números');
                return;
            }
            
            const numFactors = getFactors(num);
            const denFactors = getFactors(den);
            const commonFactors = numFactors.filter(f => denFactors.includes(f));
            const mcd = Math.max(...commonFactors);
            
            const display = document.getElementById('factorsDisplay');
            display.innerHTML = `
                <div class="factor-box">
                    <h4>Factores de ${num}:</h4>
                    <div class="factor-list">
                        ${numFactors.map(f => `<span class="factor-item ${commonFactors.includes(f) ? 'common' : ''}">${f}</span>`).join('')}
                    </div>
                </div>
                <div class="factor-box">
                    <h4>Factores de ${den}:</h4>
                    <div class="factor-list">
                        ${denFactors.map(f => `<span class="factor-item ${commonFactors.includes(f) ? 'common' : ''}">${f}</span>`).join('')}
                    </div>
                </div>
                <div class="factor-box" style="grid-column: 1 / -1;">
                    <h4>🎯 MCD = ${mcd}</h4>
                    <p>Factores comunes: ${commonFactors.join(', ')}</p>
                    ${mcd > 1 ? `<p>La fracción ${num}/${den} se puede simplificar a ${num/mcd}/${den/mcd}</p>` : `<p>La fracción ${num}/${den} ya está simplificada</p>`}
                </div>
            `;
            
            display.style.display = 'grid';
            addPoints(10);
        }

        function startClassificationGame() {
            const fractions = [
                {num: 3, den: 4, simplified: true},
                {num: 6, den: 8, simplified: false},
                {num: 5, den: 7, simplified: true},
                {num: 10, den: 15, simplified: false},
                {num: 2, den: 3, simplified: true},
                {num: 12, den: 18, simplified: false},
                {num: 7, den: 11, simplified: true},
                {num: 14, den: 21, simplified: false}
            ];
            
            // Mezclar fracciones
            gameCards = fractions.sort(() => Math.random() - 0.5);
            
            const container = document.getElementById('gameCards');
            container.innerHTML = gameCards.map((f, i) => `
                <div class="fraction-card" draggable="true" ondragstart="drag(event)" data-index="${i}" data-simplified="${f.simplified}">
                    ${f.num}/${f.den}
                </div>
            `).join('');
            
            // Limpiar zonas de drop
            document.getElementById('simplifiedZone').classList.remove('correct', 'incorrect');
            document.getElementById('complexZone').classList.remove('correct', 'incorrect');
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.innerHTML = zone.innerHTML.split('<div')[0]; // Mantener solo el contenido original
            });
        }

        function allowDrop(ev) {
            ev.preventDefault();
            ev.target.closest('.drop-zone').classList.add('drag-over');
        }

        function drag(ev) {
            ev.dataTransfer.setData("text", ev.target.dataset.index);
        }

        function drop(ev) {
            ev.preventDefault();
            const index = ev.dataTransfer.getData("text");
            const card = document.querySelector(`[data-index="${index}"]`);
            const dropZone = ev.target.closest('.drop-zone');
            
            dropZone.classList.remove('drag-over');
            dropZone.appendChild(card);
            card.style.margin = '5px';
        }

        function checkClassification() {
            let correct = 0;
            let total = 0;
            
            // Verificar zona simplificada
            const simplifiedZone = document.getElementById('simplifiedZone');
            const simplifiedCards = simplifiedZone.querySelectorAll('.fraction-card');
            
            simplifiedCards.forEach(card => {
                total++;
                if (card.dataset.simplified === 'true') {
                    correct++;
                    card.classList.add('simplified');
                } else {
                    card.style.border = '3px solid #f44336';
                }
            });
            
            // Verificar zona compleja
            const complexZone = document.getElementById('complexZone');
            const complexCards = complexZone.querySelectorAll('.fraction-card');
            
            complexCards.forEach(card => {
                total++;
                if (card.dataset.simplified === 'false') {
                    correct++;
                    card.classList.add('complex');
                } else {
                    card.style.border = '3px solid #f44336';
                }
            });
            
            const score = Math.round((correct / total) * 100);
            addPoints(score > 70 ? 25 : 10);
            
            alert(`¡Clasificación completada!\nPuntuación: ${correct}/${total} (${score}%)\n${score > 70 ? '¡Excelente trabajo!' : 'Sigue practicando'}`);
        }

        function generatePracticeExercises() {
            const container = document.getElementById('practiceContainer');
            container.innerHTML = practiceExercises.map((exercise, i) => `
                <div class="exercise-item" id="exercise${i}">
                    <div class="exercise-fraction">${exercise.num}/${exercise.den} =</div>
                    <div class="answer-input">
                        <input type="number" id="num${i}" placeholder="?" min="1" max="50">
                        <div class="fraction-line"></div>
                        <input type="number" id="den${i}" placeholder="?" min="1" max="50">
                        <button class="check-btn" onclick="checkExercise(${i})">✓</button>
                        <span class="result-icon" id="result${i}"></span>
                    </div>
                </div>
            `).join('');
        }

        function checkExercise(index) {
            const exercise = practiceExercises[index];
            const userNum = parseInt(document.getElementById(`num${index}`).value);
            const userDen = parseInt(document.getElementById(`den${index}`).value);
            const resultIcon = document.getElementById(`result${index}`);
            
            if (!userNum || !userDen) {
                alert('Por favor completa ambos campos');
                return;
            }
            
            if (userNum === exercise.ansNum && userDen === exercise.ansDen) {
                resultIcon.innerHTML = '✅';
                resultIcon.style.color = '#4caf50';
                addPoints(20);
                completedExercises++;
                updateDisplay();
                
                // Deshabilitar inputs
                document.getElementById(`num${index}`).disabled = true;
                document.getElementById(`den${index}`).disabled = true;
                document.querySelector(`#exercise${index} .check-btn`).disabled = true;
                
                if (completedExercises === practiceExercises.length) {
                    setTimeout(() => {
                        document.getElementById('achievementsSection').style.display = 'block';
                        alert('¡Felicitaciones! Has completado todos los ejercicios de simplificación. 🎉');
                    }, 1000);
                }
            } else {
                resultIcon.innerHTML = '❌';
                resultIcon.style.color = '#f44336';
                setTimeout(() => {
                    alert(`Incorrecto. La respuesta correcta es ${exercise.ansNum}/${exercise.ansDen}`);
                }, 100);
            }
        }

        // Agregar animación CSS
        const style = document.createElement('style');
        style.textContent = `
            @keyframes floatUp {
                0% {
                    opacity: 1;
                    transform: translate(-50%, -50%) scale(1);
                }
                100% {
                    opacity: 0;
                    transform: translate(-50%, -150%) scale(1.5);
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html> 